;; netkeeper-nids
;; plugin_id: 1647
;; Jose Luis Dorado
;; 

[DEFAULT]
plugin_id=1647

[config]
type=detector
enable=yes

source=log
location=/var/log/netkeeper-nids.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=
start=no	; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
#startup=/etc/init.d/%(process)s start
#shutdown=/etc/init.d/%(process)s stop
restart=yes  ; restart plugin process after each interval
restart_interval=\_CFG(watchdog,restart_interval) ; interval between each restart


# list of sids (comma separated) to be excluded by the detector
#exclude_sids=200,302,404,403

#[translation]


[00 - Netkeeper Default Rule]
# Jun 13 16:04:04 210.69.109.85 BroadWeb: 2011-06-13 16:04:04, $deviceType=NetKeeper NIPS, $deviceName=NK-5Admin (210.69.109.69), $IfNo=0, $ruleId=1051750, $ruleName=MAIL Yahoo access via TCP -4, $ori=Built-In, $cat=Access Control, $srcIp=119.160.245.252, $dstIp=172.21.36.31, $srcPort=80, $dstPort=1987, $bTime=2011-06-13 16:04:04, $eTime=2011-06-13 16:04:04, $cnt=1, $action=Log Event|Monitor
event_type=event
regexp=(?P<date>\w+\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+BroadWeb:.+\$ruleName=(?P<rule>.+),\s+\$ori.+\$srcIp=(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),\s+\$dstIp=(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),\s+\$srcPort=(?P<src_port>\d+),\s+\$dstPort=(?P<dst_port>\d+),.+\$action=(?P<action>.*)

plugin_sid=1
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src_ip)}
src_port={$src_port}
dst_ip={resolv($dst_ip)}
dst_port={$dst_port}
userdate1=Rule: {$rule}
userdata2=Action: {$action}


[01 - Netkeeper Start Rule]
# Jun 13 15:52:53 210.69.109.85 BroadWeb: 2011-06-13 15:52:53, $deviceType=BEMS, $deviceName=BEMS Server 1 (210.69.109.85), $desc=System started.
event_type=event
regexp=(?P<date>\w+\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+BroadWeb:.+\$deviceName=(?P<dev_name>.+)\((?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\),\s+\$desc=(?P<desc>.+)
plugin_sid=2
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src_ip)}
userdate1=Device Name: {$dev_name}
userdata2=Description: {$Desc}

