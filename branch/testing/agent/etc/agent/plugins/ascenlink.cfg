;; Ascenlink
;; Xtera's WAN Load Balancer
;;
;; type: detector
;; plugin_id: 1660 & 1661

[DEFAULT]
plugin_id=1660

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]

; ICMP types, no need to translate:
;
;  0 echo reply
;  3 dest unreachable
;  4 source quench
;  5 redirect
;  8 echo
;  9 router advertisement
; 10 router solicitation
; 11 time exceeded
; 12 ip header bad
; 13 timestamp request
; 14 timestamp reply
; 15 information request
; 16 information reply
; 17 address mask request
; 18 address mask reply

ICMP=20
47(GRE)=21

UDP=25
Unknown(UDP)=25
TCP=30
Unknown(TCP)=30

DNS=41
FTP=42
H323=43
HTTP=44
HTTPS=45
IMAP=46
NTP=47
POP3=48
RDP=49
SMTP=50
SNMP=51
SSH=52
TELNET=53

pcAnywhere-D=80
pcAnywhere-S=81


### AscenLink Network Events ###

[01-ascenlink-generic-event]
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}).*?PROTO=(\S+) SRC=(\IPV4):(\PORT) DST=(\IPV4):(\PORT)
date={normalize_date($1)}
plugin_id=1660
plugin_sid={translate($2)}
src_ip={resolv($3)}
src_port={$4}
dst_ip={resolv($4)}
dst_ip={$5}

[02-ascenlink-icmp-event]
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}).*?PROTO=ICMP TYPE=(\d+).*?SRC=(\S+).*?DST=(\S+)
date={normalize_date($1)}
plugin_id=1660
plugin_sid={$2}
src_ip={resolv($3)}
dst_ip={resolv($4)}


### AscenLink System Events ###

[Ascenlink-logged-in]
# (user) logged in from (src_ip)
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (\S+) logged in from (\IPV4)
date={normalize_date($1)}
username={$2}
src_ip={$3}
plugin_id=1661
plugin_sid=101

[Ascenlink-logged-out]
# (user) logged out from (dst_ip)
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) (\S+) logged out from (\IPV4)
date={normalize_date($1)}
username={$2}
dst_ip={$3}
plugin_id=1661
plugin_sid=102

[Ascenlink-password]
# Incorrect (user) password from (src_ip)
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) Incorrect (\S+) password from (\IPV4)
date={normalize_date($1)}
username={$2}
src_ip={$3}
plugin_id=1661
plugin_sid=103

[Ascenlink-failed-to-browse]
# Failed to browse (filename)
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) Failed to browse (.*)
date={normalize_date($1)}
filename={$2}
plugin_id=1661
plugin_sid=104

[Ascenlink-failed-to-push]
# Failed to push (filename)
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) Failed to push (.*)
date={normalize_date($1)}
filename={$2}
plugin_sid=105

[Ascenlink-wlan-link-failure]
# WAN link (#link) failure
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) WAN link (\d+) failure
date={normalize_date($1)}
userdata1={$2}
plugin_id=1661
plugin_sid=106

[Ascenlink-wlan-link-recovery]
# WAN link (#link) recovery
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) WAN link (\d+) recovery
date={normalize_date($1)}
userdata1={$2}
plugin_id=1661
plugin_sid=107

[Ascenlink-settings]
# Settings are applied for page (section)
# Settings are applied for page Log -> Control
# Settings are applied for page Service -> SNMP
# Settings are applied for page System -> Network
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) Settings are applied for page (.*)
userdata1={$2}
plugin_id=1661
plugin_sid=108

[Ascenlink-reboot]
# System reboot
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) System reboot
plugin_id=1661
plugin_sid=109

[Ascenlink-pushing-finished]
# Pushing Auto & Persistent Routing Log is finished
# Pushing Backup Line Log is finished
# Pushing BM Log is finished
# Pushing Cache Redirect Log is finished
# Pushing Connection Limit Log is finished
# Pushing Dynamic IP Log is finished
# Pushing Firewall Log is finished
# Pushing IP-MAC Mapping Log is finished
# Pushing Multihoming Log is finished
# Pushing NAT Log is finished
# Pushing System Log is finished
# Pushing System Log is initiated
# Pushing Virtual Server Log is finished
event_type=event
regexp=(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}) Pushing (.*?) Log is finished
userdata1={$2}
plugin_id=1661
plugin_sid=110


#Monitor account Monitor password successfully changed


