;; siteprotector
;; plugin_id: 1611
;;

[DEFAULT]
plugin_id=1611

[config]
type=detector
enable=yes

source=log
location=/var/log/siteprotector.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=true

process=getRealSecure
start=yes
stop=no
startup=nohup python /usr/share/ossim/scripts/getRealSecure.py &
shutdown=

[siteprotector-generic]
#716631.0,Email_Error,2009-12-03 18:07:35,62.97.120.33,212.253.106.91,62.97.120.67,2442,0
#210323531,HTTP_IIS_Double_Eval_Evasion,2010-02-17 11:33:13,172.31.147.222,172.29.244.95,172.29.199.249,3335,8080,:Protocol Name:TCP, :target-ip-addr-start:172.29.199.249, :target-ip-addr-end:172.29.199.249, :event-type:Attack, :repeat-count:1, :URL:/atoms/86/3d/74/3f/863d743f2df3dd9f1585be5befac4fc8.swf, :arg:clickTAG=http%3A%2F%2Fads%2Ebluelithium%2Ecom%2Fclick2%2CVaUDAIneCwCSPD0AAAAAAPatDgAAAAAAAAAqVg8AAAAAAAsAAQAEDYowAgAAAAAAz6oUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDXAIAAAAAAAIAAgAAAAAAjQO02yYBAAAAAAAAADNiNGJmOTJhLTFiY, :server:content.yieldmanager.edgesuite.net, :httpsvr:Apache, :accessed:yes, :code:200, :coalescer-info:Forwarded due to age, :adapter:A, algorithm-id:2106051, SensorName:Ribera_de_Loira, IANAProtocolId:6, AdapterMode:Monitoring, ResponseFilterID:0,

event_type=event
regexp="(?P<id>[^,]+),(?P<name>[^,]+),(?P<date>[^,]+),(?P<sensor>[^,]+),(?P<src_ip>[^,]+),(?P<dst_ip>[^,]+),(?P<src_port>[^,]+),(?P<dst_port>[^,]+),(.*:login:(?P<login>\S+),)?(.*)"
#regexp="(?P<id>[^,]+),(?P<name>[^,]+),(?P<date>[^,]+),(?P<sensor>[^,]+),(?P<src_ip>[^,]+),(?P<dst_ip>[^,]+),(?P<src_port>[^,]+),(?P<dst_port>[^,]+),.*"
#regexp="SensorDataRowID: (?P<id>[^,]+), AlertName: (?P<name>[^,]+), AlertDateTime: (?P<date>[^,]+), SensorAddress: (?P<sensor>[^,]+), SrcAddress: (?P<src_ip>[^,]+), DestAddress: (?P<dst_ip>[^,]+), SourcePort: (?P<src_port>[^,]+), DstPort: (?P<dst_port>[^,]+),.*"
date={normalize_date($3)}
src_ip={$src_ip}
dst_ip={$dst_ip}
sensor={$sensor}
dst_port={$dst_port}
src_port={$src_port}
plugin_sid={iss_siteprotector_sid($2)}
username={$login}
userdata8=spain
