;; cisco-ace
;; plugin_id: 1653
;; 
;;

[DEFAULT]
plugin_id=1653

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog
create_file=true

process=
start=no
stop=no
startup=
shutdown=

[Cisco ACE Rule 1]
# Src and dst ips with ports using "/" as separator
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\/(?P<src_port>\d+).*\D+(?P<dst_ip>\IPV4)\/(?P<dst_port>\d+)\D*.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$message}

[Cisco ACE Rule 2]
# Src and dst ips with ports using "()" as separator
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\((?P<src_port>\d+)\).*\D+(?P<dst_ip>\IPV4)\((?P<dst_port>\d+)\).*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$message}

[Cisco ACE Rule 3]
# Src and dst ips without ports 
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\D+.*\D+(?P<dst_ip>\IPV4)\D*.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
dst_ip={$dst_ip}
userdata1={$message}

[Cisco ACE Rule 4]
# only one ip and port
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\((?P<src_port>\d+)\)\D*.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
src_port={$src_port}
userdata1={$message}

[Cisco ACE Rule 5]
# only one ip and port
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\/(?P<src_port>\d+)\D*.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
src_port={$src_port}
userdata1={$message}

[Cisco ACE Rule 6]
# only one ip
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*\D+(?P<src_ip>\IPV4)\D*.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={$src_ip}
userdata1={$message}

[Cisco ACE Rule 6]
# no ips
event_type=event
regexp="(?P<date>\SYSLOG_DATE)\s*(?P<sensor>\S*)\s*(%)?ACE-(?P<severity>\d+)-(?P<plugin_sid>\d+)(:)?\s*(?P<message>.*$)"
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$plugin_sid}
src_ip={resolv($sensor)}
userdata1={$message}

