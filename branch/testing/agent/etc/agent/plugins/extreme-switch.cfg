;; extreme-switch
;; plugin_id: 1672 
;; type: detector 
;;

[DEFAULT]
plugin_id=1672

[config]
type=detector
enable=yes

source=log
location=/var/log/extreme-switch.log
create_file=true

process=
start=no   
stop=no
startup=
shutdown=

[translation]
Login passed=10
Login failed=11
link UP=20
link down=21

## rules

[Extreme Switch - Authentication Event]
#Oct 23 04:06:16 192.168.1.1 AAA: MSM-A: Login passed for user userName through telnet (192.168.1.2)
event_type=event
regexp="^(?P<datestamp>\SYSLOG_DATE)\s+(?P<saddr>\IPV4)\s+AAA\:.*?\:\s+(?P<pass_fail>(Login\spassed|Login\sfailed))\s+for\suser\s(?P<user>.*?)\sthrough\s(?P<service>\S+)\s\((?P<user_ip>\S+)\).*$"
date={normalize_date($datestamp)}
src_ip={$user_ip}
dst_ip={$saddr}
plugin_sid={translate($pass_fail)}
username={$user}
userdata1={$service}

[Extreme Switch - Logout Event]
#Oct 25 07:59:48 192.168.1.1 AAA: MSM-A: User userName logout from telnet (192.168.1.2)
event_type=event
regexp="^(?P<datestamp>\SYSLOG_DATE)\s+(?P<saddr>\IPV4)\s+AAA\:.*?\:\s+User\s(?P<user>.*?)\slogout\sfrom\s(?P<service>\S+)\s\((?P<user_ip>\S+)\).*$"
date={normalize_date($datestamp)}
src_ip={$user_ip}
dst_ip={$saddr}
plugin_sid=12
username={$user}
userdata1={$service}

[Extreme Switch - Interface UpDown]
#Oct 25 08:47:57 192.168.1.1 vlan.msgs: MSM-A: Port 8:22 link down
#Oct 25 08:48:00 192.168.1.1 vlan.msgs: MSM-A: Port 8:22 link UP at speed 1 Gbps and full-duplex
event_type=event
regexp="^(?P<datestamp>\SYSLOG_DATE)\s+(?P<saddr>\IPV4)\s+vlan.msgs\:.*?\:\s+Port\s+(?P<port>\d+\:\d+)\s+(?P<linkstate>(link\sUP|link\sdown))(?P<msgbody>.*)$"
date={normalize_date($datestamp)}
src_ip={$saddr}
plugin_sid={translate($linkstate)}
userdata1={$port}
serdata2={$msgbody}

[Extreme Switch - Clock Sync]
#Oct 25 01:32:49 192.168.1.1 DM: MSM-A: Setting hwclock time to system time, and broadcasting time
event_type=event
regexp="^(?P<datestamp>\SYSLOG_DATE)\s+(?P<saddr>\IPV4)\sDM\:\s+\S+\s+Setting\shwclock\stime.*$"
sensor={resolv($saddr)}
date={normalize_date($datestamp)}
src_ip={$saddr}
dst_ip={$saddr}
plugin_sid=50

[Extreme Switch - Configuration]
#Oct 25 00:01:12 192.168.1.1 cli: MSM-A: 192.168.1.2 (telnet) userName: upload configuration 192.168.1.2 /configs/archive/2011/10/25/10_198_1_251_0000/10_198_1_251_0000.xsf vr VR-Default
event_type=event
regexp="^(?P<datestamp>\SYSLOG_DATE)\s+(?P<saddr>\S+)\scli\:\s+\S+\:\s(?P<userip>\S+)\s\((?P<proto>\S+)\)\s+(?P<user>\S+?)\:\s+(?P<details>.*)$"
date={normalize_date($datestamp)}
src_ip={$userip}
dst_ip={$saddr}
plugin_sid=51
username={$user}
userdata1={$service}
userdata2={$loginfo}