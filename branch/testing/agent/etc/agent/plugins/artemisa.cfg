;; Jaime Blasco jaime.blasco@alienvault.com
;;
;; Artemisa VOIP honeypot

[DEFAULT]
plugin_id=1668

[config]
enable=yes
type=detector

source=log
rlocation=/root/artemisa_1.0.91/logs/artemisa_pjsua_*.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=
start=no ; launch plugin process when agent starts
stop=no ; shutdown plugin process when agent stops
startup=

[1 - Recv]
#[2011-10-28 13:06:36,970 DEBUG core 13:06:36.970   pjsua_core.c  RX 401 bytes Request msg INVITE/cseq=1 (rdata0x166bd48) from UDP 127.0.0.1:5061:
event_type=event
regexp=(?P<date>\d+-\d+-\d+\s+\d+:\d+:\d+)[^\s]+\s+DEBUG.*Request msg (?P<command>[^/]+).*from UDP (?P<src_ip>[^:]+):(?P<port>\d+).*
plugin_sid=1
date={normalize_date($date)}
src_ip={$src_ip}
src_port={$port}
userdata1={$command}

[1 - Sent]
#2011-10-28 14:17:01,012 DEBUG core 14:17:01.012   pjsua_core.c  TX 546 bytes Request msg REGISTER/cseq=58791 (tdta0x13222e0) to UDP 127.0.0.1:5065:
event_type=event
regexp=(?P<date>\d+-\d+-\d+\s+\d+:\d+:\d+)[^\s]+\s+DEBUG.*Request msg (?P<command>[^/]+).*to UDP (?P<dst_ip>[^:]+):(?P<port>\d+).*
plugin_sid=2
date={normalize_date($date)}
dst_ip={$dst_ip}
dst_port={$port}
userdata1={$command}

