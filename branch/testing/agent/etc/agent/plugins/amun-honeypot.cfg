;; Amun Honeypot plugin
;; Jaime Blasco jaime.blasco@alienvault.com

[DEFAULT]
plugin_id=1662

[config]
enable=yes
type=detector

source=log
location=/usr/share/ossim/honepots/amun/logs/amun_request_handler.log;/usr/share/ossim/honepots/amun/logs/exploits.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=nepenthes
start=no    ; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
startup=
shutdown=

[amun - Incoming Connection]
#2011-10-17 10:43:21,523 INFO [amun_request_handler] unknown vuln (Attacker: 192.168.2.103 Port: 445, Mess: ['asdadfjoasdpf+asdf\r\n'] (20) Stages: ['MS08067_STAGE1', 'MS06040_STAGE1', 'MS06070_STAGE1', 'DNSV2_STAGE1', 'ASN1_STAGE1', 'DCOM_STAGE1', 'PNP_STAGE1', 'LSASS_STAGE1'])
regexp="(?P<date>\d+-\d+-\d+\s+\d+:\d+:\d+).*amun_request_handler.*Attacker: (?P<source>\d+.\d+.\d+.\d+) Port: (?P<port>\d+).*"
event_type=event
plugin_sid=1
date={normalize_date($date)}
src_ip={resolv($source)}
dst_port={$port}

[amun - Exploit]
#2011-10-17 10:53:38,426 INFO exploit 192.168.2.105:51601 -> 192.168.2.105:42 (WINS Vulnerability: None) (Shellcode: None)
regexp="(?P<date>\d+-\d+-\d+\s+\d+:\d+:\d+).*exploit (?P<source>\d+.\d+.\d+.\d+):(?P<src_port>\d+) -> (?P<destination>\d+.\d+.\d+.\d+):(?P<dst_port>\d+) \((?P<vuln>[^:]+):.*"
event_type=event
plugin_sid=2
date={normalize_date($date)}
src_ip={resolv($source)}
dst_ip={resolv($destination)}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$vuln}



