;; extreme-wireless
;; plugin_id: 1673
;; type: detector 
;;

[DEFAULT]
plugin_id=1673

[config]
type=detector
enable=yes

source=log
location=/var/log/extreme-wireless.log
create_file=true

process=
start=no   
stop=no
startup=
shutdown=

[translation]
registration succeeded=10
registration failed=11
de-registration succeeded=20
de-registration failed=21
DHCPACK=30
DHCPNAK=31
DHCPOFFER=32
DHCPREQUEST=33
DHCPDISCOVER=34

## rules

[Extreme Wireless - Registration Event]
#Oct 23 04:39:07 wm100-1 extreme: MU Session Manager Client session registration succeeded ( MU[00:00:00:00:00:00] SSID[WIRELESS-A] WAP[1000000000000000] RADIO[b/g]) 3
event_type=event
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:.*?Session\sManager\sClient\s+session\s+(?P<pass_fail>(registration\ssucceeded|registration\sfailed))\s+\(\s+MU\[(?P<macaddr>\S{17})\]\s+SSID\[(?P<ssid>\S+?)\]\s+WAP\[(?P<wap_sn>\S+)\].*$"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid={translate($pass_fail)}
userdata1={$macaddr}
userdata2={$ssid}
userdata3={$wap_sn}

[Extreme Wireless - De-Registration Event]
#Oct 23 09:25:30 wm100-1 extreme: MU Session Manager Client session de-registration succeeded ( MU[00:00:00:00:00:00] WM-AD[AD-Group]) Reason is: Idle timeout. 3
event_type=event
precheck="Session Manager Client session de-registration"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:.*?Session\sManager\sClient\s+session\s+(?P<pass_fail>(de-registration\ssucceeded|de-registration\sfailed))\s+\(\s+MU\[(?P<macaddr>\S+?)\]\s+WM-AD\[(?P<auth>.*?)\]\)\s+Reason\sis\:\s(?P<reason>.*?)\."
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid={translate($pass_fail)}
userdata1={$macaddr}
userdata2={$auth}
userdata3={$reason}

[Extreme Wireless - Roaming Internal]
#Oct 23 03:43:58 wm100-1 extreme: MU Session Manager Client roaming ( MU[00:00:00:00:00:00] roam inside SWM from WAP[1000000000000000] RADIO[b/g] to WAP[1000000000000000] RADIO[b/g] WM-AD[AD-Group]) 3
event_type=event
precheck="Session Manager Client roaming"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:.*?Session\sManager\sClient\s+roaming\s\(\sMU\[(?P<macaddr>\S+)\]\sroam\sinside\sSWM\sfrom\sWAP\[(?P<wap_from_sn>\S+)\].*?WAP\[(?P<wap_to_sn>\S+)\].*?WM-AD\[(?P<auth>.*?)\]\).*$"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid=12
username={$auth}
userdata1={$macaddr}
userdata2={$wap_from_sn}
userdata3={$wap_to_sn}

[Extreme Wireless - Roaming Out to In]
#Oct 30 22:26:05 wm100-2 extreme: MU Session Manager Client roaming ( MU[00:00:00:00:00:00] roam from foreign SWM[192.168.1.100] to home SWM[WAP:1000000000000000]) 3
event_type=event
precheck="Session Manager Client roaming"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:.*?Session\sManager\sClient\s+roaming\s\(\sMU\[(?P<macaddr>\S+)\]\sroam\sfrom\sforeign\sSWM\[\:(?P<wap_from_sn>\S+)\].*?\[WAP\:(?P<wap_to_sn>\S+)\].*$"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid=12
userdata1={$macaddr}
userdata2={$wap_from_sn}
userdata3={$wap_to_sn}

[Extreme Wireless - Roaming In to Out]
#Oct 30 22:24:44 wm100-2 extreme: MU Session Manager Client roaming ( MU[00:00:00:00:00:00] roam from home SWM[WAP:1000000000000000] to foreign SWM[192.168.1.5]) 3
event_type=event
precheck="Session Manager Client roaming"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:.*?Session\sManager\sClient\s+roaming\s\(\sMU\[(?P<macaddr>\S+)\]\sroam\sfrom\shome\sSWM\[WAP\:(?P<wap_from_sn>\S+)\].*?SWM\[(?P<wap_to_sn>\S+)\].*$"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid=12
userdata1={$macaddr}
userdata2={$wap_from_sn}
userdata3={$wap_to_sn}

[Extreme Wireless - DHCPACK Event]
#Oct 28 15:50:11 wm100-2 dhcpd: DHCPACK on 192.168.1.5 to 00:00:00:00:00:00 (host-name) via esa4
event_type=event
precheck="DHCPACK"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPACK)\son\s(?P<dhcp_ip>\S+)\sto\s(?P<mac_addr>\S+)\s\((?P<hostname>.*?)\).*" 
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=30
userdata1={$mac_addr}
userdata2={$hostname}

[Extreme Wireless - DHCPACK Event2]
#Oct 24 10:12:00 wm100-1 dhcpd: DHCPACK on 192.168.1.5 to 00:00:00:00:00:00 via esa4
event_type=event
precheck="DHCPACK"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPACK)\son\s(?P<dhcp_ip>\S+)\sto\s(?P<mac_addr>\S+)\svia.*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=30
userdata1={$mac_addr}


[Extreme Wireless - DHCPREQUEST Error]
#Oct 28 16:41:27 wm100-2 dhcpd: DHCPREQUEST for 192.168.1.5 from 00:00:00:00:00:00 via esa4: wrong network.
event_type=event
precheck="DHCPREQUEST"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPREQUEST)\sfor\s(?P<dhcp_ip>\S+)\sfrom\s(?P<mac_addr>\S+).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=36
userdata1={$macaddr}

[Extreme Wireless - DHCPREQUEST Event]
#Oct 24 08:56:22 wm100-1 dhcpd: DHCPREQUEST for 192.168.1.5 (172.16.1.1) from 00:00:00:00:00:00 (host-name) via esa4
event_type=event
precheck="DHCPREQUEST"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPREQUEST)\sfor\s(?P<dhcp_ip>\S+)\s\((?P<gateway>\S+)\)\sfrom\s(?P<mac_addr>\S+)\s+\((?P<hostname>\S+?)\)"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=33
userdata1={$macaddr}
userdata2={$hostname}
userdata3={$dhcp_ip}

[Extreme Wireless - DHCPNAK Event]
#Oct 28 16:41:27 wm100-2 dhcpd: DHCPNAK on 192.168.1.1 to 00:00:00:00:00:00 via esa4
event_type=event
precheck="DHCPNAK"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPNAK)\son\s(?P<dhcp_ip>\S+)\sto\s(?P<mac_addr>\S+).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=31
userdata1={$macaddr}

[Extreme Wireless - DHCPDISCOVER Event]
#Oct 28 16:41:27 wm100-2 dhcpd: DHCPDISCOVER from 00:00:00:00:00:00 (host-name) via esa4
event_type=event
precheck="DHCPDISCOVER"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPDISCOVER)\sfrom\s(?P<mac_addr>\S+)\s\((?P<hostname>.*?)\).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid=34
userdata1={$macaddr}
userdata2={$hostname}

[Extreme Wireless - DHCPDISCOVER Event2]
#Oct 24 09:50:47 wm100-1 dhcpd: DHCPDISCOVER from 00:00:00:00:00:00 via esa4
event_type=event
precheck="DHCPDISCOVER"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPDISCOVER)\sfrom\s(?P<mac_addr>\S+)\svia.*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($shost)}
plugin_sid=34
userdata1={$macaddr}
userdata2={$hostname}

[Extreme Wireless - DHCPOFFER Event]
#Oct 28 16:41:28 wm100-2 dhcpd: DHCPOFFER on 192.168.1.1 to 00:00:00:00:00:00 (host-name) via esa4
event_type=event
precheck="DHCPOFFER"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPOFFER)\son\s(?P<dhcp_ip>\S+)\sto\s(?P<mac_addr>\S+)\s\((?P<hostname>.*)\).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=32
userdata1={$mac_addr}
userdata2={$hostname}

[Extreme Wireless - DHCPOFFER Event2]
#Oct 24 08:38:09 wm100-1 dhcpd: DHCPOFFER on 192.168.1.1 to 00:00:00:00:00:00 via esa4
#Oct 28 17:19:35 wm100-1 dhcpd: DHCPOFFER on 192.168.1.1 to 00:00:00:00:00:00 via esa4
event_type=event
precheck="DHCPOFFER"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\s(?P<dhcp_type>DHCPOFFER)\son\s(?P<dhcp_ip>\S+)\sto\s(?P<mac_addr>\S+).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
dst_ip={resolv($dhcp_ip)}
plugin_sid=32
userdata1={$mac_addr}
userdata2={$hostname}

[Extreme Wireless - DHCP Write Leases]
#Oct 24 08:56:22 wm100-1 dhcpd: Wrote 26 leases to leases file.
event_type=event
precheck="leases to leases file"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\sWrote\s(?P<leasenum>\d+).*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=35
username={$auth}
userdata1={$macaddr}
userdata2={$hostname}

[Extreme Wireless - DHCPINFORM]
#Oct 24 10:16:07 wm100-1 dhcpd: DHCPINFORM from 192.168.1.1 via esa4
event_type=event
precheck="DHCPINFORM"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+dhcpd\:\sDHCPINFORM\sfrom\s(?P<ipaddr>\S+)"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=39
userdata1={$ipaddr}

[Extreme Wireless - WAP Disconnect]
#Oct 24 01:15:20 wm100-1 extreme: Site ID has closed it's message bus connection 3
event_type=event
precheck="message bus connection"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:\s(?P<nodeid>.*?)has\sclosed\sit\'s\smessage\sbus\sconnection.*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=37
userdata1={$nodeid}

[Extreme Wireless - State Change]
#Oct 26 14:45:51 wm100-1 extreme: MU Session Manager Client session state changed ( MU[00:00:00:00:00:00] WM-AD[AD-Group] IP=192.168.1.1 ) 3
event_type=event
precheck="Session Manager Client session state changed"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:\sMU\sSession\sManager\sClient\ssession\sstate\schanged\s\(\sMU\[(?P<macaddr>\S+)\]\sWM-AD\[(?P<auth>\S+)\]\sIP.(?P<ipaddr>\S+)\s*"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=22
userdata1={$nodeid}

[Extreme Wireless - Backup Event]
#Oct 27 01:15:11 wm100-1 extreme: CLI root CLI_system_management backup Success upload backup file WM100-01.27102011.011504 to server 192.168.1.1 3
#Oct 27 01:15:10 wm100-1 extreme: CLI root CLI_system_management backup SUCCESS to complete backup/export: backup/export file: WM100-01.27102011.011504. 3
event_type=event
precheck="CLI_system_management backup"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:\sCLI\s(?P<username>\S+)(?P<message>.*backup.*)"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=38

[Extreme Wireless - Backup Started]
#Oct 31 01:15:04 wm100-1 extreme: CLI Back-up process started. 3
event_type=event
precheck="CLI Back-up process started"
regexp="^(?P<datestamp>\w\w\w\s\d\d\s\d\d\:\d\d\:\d\d)\s+(?P<shost>\S+)\s+extreme\:\sCLI\s(?P<message>.*)"
date={normalize_date($datestamp)}
src_ip={resolv($shost)}
plugin_sid=38


[ZExtreme - datamining - all]
#Mar  2 22:45:06 192.168.1.2 kernel: 03 1fd4b030 1fd4b040 0001800d(03) 00000000 00000000
event_type=event
regexp="^(?P<logline>(?P<date>\SYSLOG_DATE)\s+(?P<sensor>\S+)\s+(?P<source>\S+)\s+(?P<logged_event>.*)$)"
sensor={resolv($sensor)}
date={normalize_date($date)}
plugin_sid=2000000000
sensor={resolv($sensor)}
userdata1={md5sum($logline)}
userdata2={$logline}
userdata3={$logged_event}