;;
;; aix-audit
;;
;; description: IBM AIX Audit Logs
;; type: detector
;; plugin_id: 1649
;;
;; **Logs fetched using Snare Epilog**
;; 

[DEFAULT]
plugin_id=1649

[config]
type=detector
enable=yes
source=log
location=/var/log/syslog
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]
# sids
USER_Login=1
USER_Logout=2
USER_Exit=3
USER_Shell=4
USER_SU=5
USER_Check=6
USER_Change=7
USER_Remove=8
USER_Create=9
USER_Exit=10
TERM_Logout=11
PASSWORD_Flags=12
PASSWORD_Check=13
PASSWORD_Ckerr=14
PASSWORD_Change=15
PASSWD_WRITE=16
GROUP_User=17
GROUP_Adms=18
GROUP_Change=19
GROUP_Create=20
GROUP_Remove=21
SYSCK_Check=22
SYSCK_Update=23
SYSCK_Install=24
S_ENVIRON_WRITE=25
S_GROUP_WRITE=26
S_LIMITS_WRITE=27
S_LOGIN_WRITE=28
S_PASSWD_READ=29
S_PASSWD_WRITE=30
S_USER_WRITE=31
TCPIP_connect=32
TCPIP_data_out=33
TCPIP_data_in=34
TCPIP_access=35
GIP_W_BDE=36
GIP_R_BDE=37
GIP_X_BDE=38
TAM_R_BDE=39
TAM_W_BDE=40
TAM_X_BDE=41
FILE_Owner=42
FILE_Mode=43
AUD_CONFIG_WR=44
SSH_X_BDE=45
SCM_R_BDE=46
KRB_X_BDE=47


[aix-audit-generic-event]
# Jul 12 11:50:21 wasaea01 AIXAudit	3	287	mar jul 12 11:50:21 2011	FILE_Mode	su	root	infmpp	14286906	13566132	OK	mode: 600 filename /var/adm/sulog
#
# Date Log  = {$1}
# Sensor    = {$2}
# TypeLog   = {$3}
# StatusN   = {$4}
# UnNumero  = {$5}
# Date      = {$6}
# EventType = {$7}
# Command   = {$8}
# Real      = {$9}
# User      = {$10}
# n1        = {$11}
# n2        = {$12}
# Status    = {$13}
# Trail     = {$14}
#
event_type=event
regexp=(\SYSLOG_DATE)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(.+? \w{3} \d{1,2}\d{1,2} \d{1,2}:\d{1,2}\d{1,2}:\d{1,2} \d{4})\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s+(.+)
date={normalize_date($1)}   ; #1  Date
plugin_sid={translate($7)}  ; #3  Event Type 
src_ip={resolv($2)}         ; #2  Sensor
username={$9}               ; #9  Real
userdata1={$7}              ; #7  Event Type
userdata2={$8}              ; #8  Command
userdata3={$10}             ; #10 User
userdata4={$14}             ; #14 Trail 

