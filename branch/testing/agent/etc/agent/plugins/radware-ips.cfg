;; radware-ips
;; plugin_id: 1645
;; Jose Luis Dorado
;; 

[DEFAULT]
plugin_id=1645

[config]
type=detector
enable=yes

source=log
location=/var/log/radware-ips.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=squid
start=no	; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
#startup=/etc/init.d/%(process)s start
#shutdown=/etc/init.d/%(process)s stop
restart=yes  ; restart plugin process after each interval
restart_interval=\_CFG(watchdog,restart_interval) ; interval between each restart


# list of sids (comma separated) to be excluded by the detector
#exclude_sids=200,302,404,403

#[translation]


[00 - Radware INFO]

# Jun 15 10:32:16 172.16.3.12 DefensePro: 15-06-2011 10:40:21 INFO Policy database updated successfully.
# Jun 15 10:33:32 172.16.3.12 DefensePro: 15-06-2011 10:41:36 INFO User radware logged in via terminal
# Jun 15 10:36:55 172.16.3.12 DefensePro: 15-06-2011 10:45:00 INFO Updating policy database...
# Jun 15 10:36:57 172.16.3.12 DefensePro: 15-06-2011 10:45:01 INFO Policy database updated successfully.
# Jun 15 10:37:46 172.16.3.12 DefensePro: 15-06-2011 10:45:50 INFO User radware logged in via web (IP: 172.16.3.11)
# Jun 15 10:40:02 172.16.3.12 DefensePro: 15-06-2011 10:48:06 INFO Updating policy database...
# Jun 15 10:40:02 172.16.3.12 DefensePro: 15-06-2011 10:48:07 INFO Policy database updated successfully.
event_type=event
regexp=(?P<date>\w+\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+DefensePro:\s+(?P<device_time>\d{1,2}-\d{1,2}-\d{4}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+INFO(?P<data>.*)

date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src)}

plugin_sid=1
userdata1=Device Time: {$device_time}
userdata3=Info: {$data}



[01 - Radware WARNING]
# Jun 15 11:28:57 172.16.3.12 DefensePro: 15-06-2011 11:37:01 WARNING 3202 Intrusions "Routers-Cisco-Proto-103-DOS" IP 172.16.7.253 0 224.0.0.13 0 7 Regular "outbound" sampled 1 0 0 0 N/A high forward
# Jun 15 11:28:57 172.16.3.12 DefensePro: 15-06-2011 11:37:01 WARNING 3202 Intrusions "Routers-Cisco-Proto-103-DOS" IP 172.16.7.253 0 224.0.0.13 0 7 Regular "all" sampled 1 0 0 0 N/A high forward
# Jun 15 11:29:02 172.16.3.12 DefensePro: 15-06-2011 11:37:06 WARNING 3202 Intrusions "Routers-Cisco-Proto-103-DOS" IP 172.16.7.253 0 224.0.0.13 0 0 Regular "outbound" ongoing 3 1 0 0 N/A high forward
# Jun 15 11:29:02 172.16.3.12 DefensePro: 15-06-2011 11:37:06 WARNING 3202 Intrusions "Routers-Cisco-Proto-103-DOS" IP 172.16.7.253 0 224.0.0.13 0 0 Regular "all" ongoing 3 1 0 0 N/A high forward
# Jun 15 11:29:12 172.16.3.12 DefensePro: 15-06-2011 11:37:16 WARNING 3202 Intrusions "Routers-Cisco-Proto-103-DOS" IP 172.16.7.253 0 224.0.0.13 0 0 Regular "outbound" term 0 0 0 0 N/A high forward

event_type=event
regexp=(?P<date>\w+\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+DefensePro:\s+(?P<device_time>\d{1,2}-\d{1,2}-\d{4}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<data>WARNING.+(IP|TCP|UDP)\s+(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<src_port>\d+)\s+(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dst_port>\d+)\s+(?P<proto>\d+).+Regular\s+("(?P<direction>all|outbound|inbound)")?.*)

date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src)}
src_port={$src_port}
dst_ip={resolv($dst)}
dst_port={$dst_port}
plugin_sid=2
userdata1=Device Time: {$device_time}
userdata2=Traffic Direction: {$direction}
userdata3={$data}
