;; cisco-3030
;; plugin_id: 1657
;; 
;; $Id: cisco3030-syslog.cfg,v 1.5 2011/05/06 12:56:12 mramos Exp $
;;

[DEFAULT]
plugin_id=1657

[config]
type=detector
enable=yes

source=log
location=/var/log/cisco-3030.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]
#AUTH: 1-999
#PPP: 1000-1999
#PPTP: 2000-2999
#IKE: 3000-3999
#HTTP: 4000-4999
#GENERIC: 9999


#AUTH/5 Authentication rejected
#AUTH/22 IPSec/LAN-to-LAN - connected
#AUTH/23 User disconnected
#AUTH/31 Authentication failure on http logon
#AUTH/36 Access granted on snmp logon
#AUTH/83 User connected
#AUTH/84 LAN-to-LAN tunnel connected

AUTH/5=5
AUTH/22=22
AUTH/23=23
AUTH/31=31
AUTH/36=36
AUTH/83=83
AUTH/84=84


#PPP/6 PPP User disconnected.
#PPP/8 PPP User Authenticated successfully with MSCHAP-V1
#PPP/9 PPP User disconnected.. failed authentication ( MSCHAP-V1 )
#PPP/12 PPP User disconnected. Authentication protocol not allowed.

PPP/6=1006
PPP/8=1008
PPP/9=1009
PPP/12=1012


#PPTP/34 Tunnel to peer closed
#PPTP/35 Session closed on tunnel
#PPTP/42 Session started on tunnel
#PPTP/47 Tunnel to peer established

PPTP/34=2034
PPTP/35=2035
PPTP/42=2042
PPTP/47=2047


#IKE/0 Received unexpected event EV_ACTIVATE_NEW_SA in state MM_ACTIVE
#IKE/34 Received local IP Proxy Subnet data in ID Payload
#IKE/35 Received remote IP Proxy Subnet data in ID Payload
#IKE/41 IKE Initiator: New Phase 1
#IKE/49 Security negotiation complete for LAN-to-LAN
#IKE/66 IKE Remote Peer configured for SA
#IKE/92 Failure during phase 1 rekeying attempt due to collision
#IKE/119 PHASE 1 COMPLETED
#IKE/120 PHASE 2 COMPLETED
#IKE/121 Keep-alive type for this connection
#IKE/136 IKE session establishment timed out

IKE/0=3000
IKE/34=3034
IKE/35=3035
IKE/41=3041
IKE/49=3049
IKE/66=3066
IKE/92=3092
IKE/119=3119
IKE/120=3120
IKE/121=3121
IKE/136=3136


#HTTP/7 HTTP 401 Unauthorized
#HTTP/47 HTTP administrator login

HTTP/7=4007
HTTP/47=4047


#CONFIG/17 Generic event

CONFIG/17=9999




[1-cisco-3030]

#May  3 11:31:13 94424343 09/28/2004 22:08:26.330 SEV=3 AUTH/5 RPT=11 10.10.89.129 Authentication rejected: Reason = User was not found handle = 44, server = (none), user = pptpusers, domain = <not specified>
#May  3 11:31:13 94424343 05/03/2011 11:30:18.500 SEV=4 AUTH/22 RPT=4148733 10.10.50.5  User [10.10.50.5] Group [10.10.50.5] connected, Session Type: IPSec/LAN-to-LAN
#May  3 11:31:13 94424351 05/03/2011 11:30:18.570 SEV=4 AUTH/23 RPT=4148410 10.10.50.5  User [10.10.50.5] Group [10.10.50.5] disconnected: duration: 0:00:00
#Apr 14 08:52:37 77570 04/14/2011 08:51:56.650 SEV=5 AUTH/31 RPT=12  User [ admin ] Protocol [ HTTP ] attempted ADMIN logon. Status: <REFUSED> authentication failure
#Apr 14 08:52:39 77573 04/14/2011 08:51:58.170 SEV=5 AUTH/36 RPT=76555 107.65.76.181  User [ SNMP ] Protocol [ SNMP ] attempted ADMIN logon. Status: <ACCESS GRANTED>
#Apr 14 08:59:16 77587 04/14/2011 08:58:35.910 SEV=4 AUTH/83 RPT=24  User [admin] connected
#May  3 11:30:45 94424183 05/03/2011 11:29:51.000 SEV=4 AUTH/84 RPT=4148728  LAN-to-LAN tunnel to headend device 10.10.50.5 connected

#May  3 11:31:13 94424343 12/05/2000 10:02:15.400 SEV=4 PPP/6 RPT=7 10.10.89.129 User [ pptpuser ] disconnected.
#May  3 11:31:13 94424343 09/28/2004 21:36:55.910 SEV=5 PPP/8 RPT=22 10.10.89.129 User [pptpuser] Authenticated successfully with MSCHAP-V1
#May  3 11:31:13 94424343 09/28/2004 22:08:26.330 SEV=5 PPP/9 RPT=11 10.10.89.129 User [pptpusers] disconnected.. failed authentication ( MSCHAP-V1 )
#May  3 11:30:45 94424188 04/22/2002 14:22:59.190 SEV=5 PPP/12 RPT=1 10.10.89.129 User [pptpuser] disconnected. Authentication protocol not allowed.

#May  3 11:31:13 94424343 09/28/2004 22:08:26.450 SEV=4 PPTP/34 RPT=44 10.10.89.129 Tunnel to peer 10.10.89.129 closed, reason: None (No additional info)
#May  3 11:31:13 94424343 09/28/2004 22:08:26.340 SEV=4 PPTP/35 RPT=44 10.10.89.129  Session closed on tunnel 10.10.89.129 (peer 32768, local 22712, serial 40761), reason: Error (No additional info)
#May  3 11:31:13 94424343 09/28/2004 22:08:23.220 SEV=4 PPTP/42 RPT=44 10.10.89.129 Session started on tunnel 10.10.89.129
#May  3 11:31:13 94424343 09/28/2004 22:08:23.210 SEV=4 PPTP/47 RPT=44 10.10.89.129 Tunnel to peer 10.10.89.129 established

event_type=event
regexp="(?P<syslog_date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+\d+\s+(?P<data>(?P<cisco3030_date>\d+/\d+/\d+\s+\d+:\d+:\d+).\d+\s+SEV=(?P<severity>\d+)\s+(?P<plugin_sid>\S+)\s+RPT=\d+\s+(LAN-to-LAN tunnel to headend device )?(?P<src_ip>\d+.\d+.\d+.\d+)?\s+(User \[(\s+)?(?P<user>\S+)(\s+)?\])?.*)"
date={normalize_date_american($cisco3030_date)}
plugin_sid={translate($plugin_sid)}
src_ip={$src_ip}
username={$user}
userdata1={$data}



[2-cisco-3030]
#Apr 14 11:13:20 123 08/09/2002 13:14:22.970 SEV=5 IKE/34 RPT=6 10.10.124.132 Group [10.10.124.132] Received local IP Proxy Subnet data in ID Payload: Address 14.38.200.0, Mask 255.255.255.0, Protocol 0, Port 0
#Apr 14 11:13:20 119 08/09/2002 13:14:22.970 SEV=5 IKE/35 RPT=4 10.10.124.132 Group [10.10.124.132] Received remote IP Proxy Subnet data in ID Payload: Address 14.38.80.0, Mask 255.255.255.0, Protocol 0, Port 0
#Apr 14 11:13:20 52778 04/29/2010 10:18:11.010 SEV=4 IKE/49 RPT=45510 1.1.1.1 Group [1.1.1.1]Security negotiation complete for LAN-to-LAN Group (1.1.1.1)
#Apr 14 11:13:20 128 08/09/2002 13:14:22.970 SEV=5 IKE/66 RPT=8 10.10.124.132 Group [10.10.124.132] IKE Remote Peer configured for SA: L2L: RTP NAT TUNNEL
#Apr 14 11:13:20 60967 05/04/2010 17:57:27.770 SEV=4 IKE/92 RPT=53805 1.1.1.1 Group [1.1.1.1] Failure during phase 1 rekeying attempt due to collision
#Apr 14 11:13:20 104 08/09/2002 13:14:22.870 SEV=4 IKE/119 RPT=8 10.10.124.132 Group [10.10.124.132] PHASE 1 COMPLETED
#Apr 14 11:13:20 197 07/27/2010 19:00:39.320 SEV=4 IKE/120 RPT=5 192.0.2.1 Group [VPNC_Base_Group] PHASE 2 COMPLETED (msgid=00000001)
#Apr 14 11:13:20 105 08/09/2002 13:14:22.870 SEV=6 IKE/121 RPT=6 10.10.124.132 Keep-alive type for this connection: DPD
#Apr 14 11:13:20 58223 05/04/2010 17:38:22.670 SEV=4 IKE/136 RPT=1269 1.1.1.1 Group [1.1.1.1]IKE session establishment timed out [MM_BLD_MSG6]  aborting!
#Apr 14 11:13:20 43002 04/14/2011 11:12:40.510 SEV=4 IKE/41 RPT=13991 192.204.106.14  IKE Initiator: New Phase 1, Intf 2, IKE Peer 192.204.106.14 local Proxy Address 27.65.76.21, remote Proxy Address 1.68.100.62, SA (L2L: C_VPN3123_Valley_Hospital)
event_type=event

regexp="(?P<syslog_date>\w{3}\s+\d{1,2}\s+\d\d:\d\d:\d\d)\s+\d+\s+(?P<data>(?P<cisco3030_date>\d+/\d+/\d+\s+\d+:\d+:\d+).\d+\s+SEV=(?P<severity>\d+)\s+(?P<sid>\S+)\s+RPT=\d+\s+(?P<IKEPeer>\d+.\d+.\d+.\d+)(.*local Proxy Address (?P<LPA>\d+.\d+.\d+.\d+), remote Proxy Address (?P<RPA>\d+.\d+.\d+.\d+))?.*)"

date={normalize_date_american($cisco3030_date)}
plugin_sid={translate($sid)}
src_ip={$IKEPeer}
dst_ip={$LPA}
userdata1={$data}

[3-cisco-3030]
#Apr 14 08:52:37 77572 04/14/2011 08:51:56.650 SEV=3 HTTP/7 RPT=21 192.168.71.205  HTTP 401 Unauthorized: Authorization Failed
#Apr 14 08:59:16 77588 04/14/2011 08:58:35.910 SEV=4 HTTP/47 RPT=24 192.168.71.205  New administrator login: admin.
event_type=event
regexp="(?P<syslog_date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+\d+\s+(?P<data>(?P<cisco3030_date>\d+/\d+/\d+\s+\d+:\d+:\d+).\d+\s+SEV=(?P<severity>\d+)\s+(?P<plugin_sid>\S+)\s+RPT=\d+\s+((?P<src_ip>\d+.\d+.\d+.\d+)\s+)?(New\s+\S+\s+login:\s+(?P<user>\S+)\.)?.*)"
date={normalize_date_american($cisco3030_date)}
plugin_sid={translate($plugin_sid)}
src_ip={$src_ip}
username={$user}
userdata1={$data}

[9999-cisco-3030]
#Apr 14 11:13:20  132 08/09/2002 13:14:22.970 SEV=6 IKE/0 RPT=5 Received unexpected event EV_ACTIVATE_NEW_SA in state MM_ACTIVE
#Apr 14 11:12:52 77868 04/14/2011 11:12:11.670 SEV=4 CONFIG/17 RPT=15  Done writing configuration file, Success.

event_type=event
regexp="(?P<syslog_date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+\d+\s+(?P<data>(?P<cisco3030_date>\d+/\d+/\d+\s+\d+:\d+:\d+).\d+\s+SEV=(?P<severity>\d+)\s+(?P<plugin_sid>\S+).*)"
date={normalize_date_american($cisco3030_date)}
plugin_sid={translate($plugin_sid)}
userdata1={$data}
