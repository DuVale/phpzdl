;; cisco-asa
;; plugin_id: 1636
;; 
;; $Id: cisco-asa.cfg,v x.x 2011/10/13 21:29:00 mramos Exp $
;;
;;
;; The order rules are defined matters.
;;

[DEFAULT]
plugin_id=1636

[config]
type=detector
enable=yes

source=log
location=/var/log/cisco-asa.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=


[100-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>.+?(for?|src?)(\s+\S+)+:(?P<src>[^\s|^/]+)(\/(?P<sport>\S+))?.+?(to?|dst?)(\s+\S+){1,2}:(?P<dst>[^\s|^/]+)(\/(?P<dport>\S+))?(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}

[200-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>Denied.+?from\s+(\S+\s+)?(?P<src>\S+)\s+on interface \S+ to (?P<dst>\S+)[:|](.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
dst_ip={$dst}

[250-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>Deny(.+)?from\s+(?P<src>\S[^/]+)(/(?P<sport>\S+))\s+to\s+(?P<dst>\S[^/]+)(/(?P<dport>\S+))\s+on\s+interface\s+(?P<iface>\S+)(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
dst_ip={$dst}
interface={$iface}

[300-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>Deny.+?from\s+(\()?(?P<src>\S[^)]+)((\)))?(\s+)?to\s+(?P<dst>\S+)\s+on\s+interface\s+(?P<interface>\S+)(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
dst_ip={$dst}

[350-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>(.+)?IPSEC(.+)?protocol=(\s+)?(?P<proto>\S[^)]+)(.+)?from\s+(?P<src>\S+)\s+to\s+(?P<dst>\S+)(\.)(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
dst_ip={$dst}
interface={$iface}
protocol={$proto}

[400-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>(.+)?(faddr|from)\s+(\S+:)?(?P<src>\S[^/|\s]+)((\/(?P<sport>\S+))?.+(gaddr|to)\s+(\S+:)?(?P<dst>\S[^/|\s+|,]+)(\/(?P<dport>\S[^,]+)(,)?)?(.+)?)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}

[500-cisco-asa]
#Oct 20 12:47:21 2.7.55.214 %PIX-4-407001: Deny traffic for local-host inside:192.168.1.15, license limit of 10 exceeded
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>(.+)?local-host\s+(?P<iface>\S+):(?P<src>\S[^,]+)(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
src_ip={$src}
interface={$iface}

[600-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-(?P<severity>\d+)-(?P<sid>\d+):\s+(?P<userdata>(?P<src>\S+)\s+Accessed\s+URL\s+(?P<dst>\S[^:|\s+]+)(:)?(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$sid}
src_ip={$src}
dst_ip={$dst}

[700-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-(?P<severity>\d+)-(?P<sid>\d+):\s+(?P<userdata>(.+)?(ip|IP)\s+=\s+(?P<src>\S[^,]+)(,)?(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$sid}
src_ip={$src}

[800-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-(?P<severity>\d+)-(?P<sid>\d+):\s+(?P<userdata>(.+)?address\s+granted(.+)?\((?P<src>\S[^,|^)]+)(,|\))(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}
plugin_sid={$sid}
src_ip={$src}

[9999-cisco-asa]
regexp="((?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+)\s+)?%\w+-\d-(?P<sid>\d+):\s+(?P<userdata>(.+)?)"
event_type=event
date={normalize_date($date)}
sensor={resolv($sensor)}        
plugin_sid={$sid}
